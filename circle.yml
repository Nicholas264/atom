machine:
  environment:
    XCODE_SCHEME: test
    XCODE_WORKSPACE: test
    XCODE_PROJECT: test

  xcode:
    version: 7.3

general:
  artifacts:
    - out/Atom.zip

dependencies:
  pre:
    - curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.31.3/install.sh | bash
    - nvm install 4.4.7
    - nvm use 4.4.7
    - npm install -g npm

  override:
    - script/bootstrap
    - build/build.js

  post:
    - zip -r out/Atom.zip out/Atom-darwin-x64

  cache_directories:
    - cache
    - apm/node_modules
    - build/node_modules
    - node_modules

test:
  override:
    - out/Atom-darwin-x64/Atom.app/Contents/MacOS/Atom --resource-path $(pwd) --test spec
